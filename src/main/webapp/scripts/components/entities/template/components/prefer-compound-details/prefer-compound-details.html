<div class="compound-component panel panel-info component " indigo-collapsible-component>
    <div class="panel-heading">
        Preferred Compound Details
    </div>
    <div class="collapsible">
        <div class="panel-body">
            <form class="form-inline form-compound-details">
                <label>Notebook ID #: <span ng-bind="vm.notebookId"></span><span> -</span></label>
                <indigo-select
                        indigo-model="vm.selectedBatch"
                        indigo-items="vm.batches"
                        indigo-change="vm.selectBatch(vm.selectedBatch)"
                        indigo-item-prop="nbkBatch"
                        indigo-control = "vm.selectControl"
                        class="select-inline"
                ></indigo-select>
                <indigo-checkbox
                        indigo-model="vm.showSummary"
                        indigo-label="Show Summary"
                ></indigo-checkbox>
            </form>

            <indigo-compound-summary ng-if="vm.showSummary"
                              my-tab-support="true"
                              model="vm.model"
                              save-experiment-fn="vm.saveExperimentFn()"
                              is-hide-column-settings="true"
                              batches="vm.batches"
                              selected-batch="vm.selectedBatch"
                              selected-batch-trigger="vm.selectedBatchTrigger"
                              is-readonly="vm.isReadonly"
                              on-added-batch="vm.onAddedBatch({batch: batch})"
                              batch-operation="vm.batchOperation"
                              on-select-batch="vm.onSelectBatch({batch: batch})"
                              on-remove-batches="vm.onRemoveBatches({batches: batches})"
        ></indigo-compound-summary>

            <div class="row m-b20">
                <div class="col-xs-12 text-right">
                    <div class="search-field">
                        <span class="fa fa-search"></span>
                        <input type="search" class="uui-search" placeholder="Search" ng-change="search()"
                               press-enter="$event.preventDefault()" ng-model="searchText">
                    </div>
                    <div class="btn-group btn-group-sm m-l10" uib-dropdown dropdown-append-to-body ng-if="!myHideColumnSettings">
                        <div id="show-hide-button" class="btn btn-info"
                             uib-dropdown-toggle
                             ng-disabled="disabled"
                             uib-tooltip="Column settings">
                            <span class="fa fa-columns no-draggable" aria-hidden="true"></span> &nbsp;<span> Columns</span>
                        </div>
                        <ul uib-dropdown-menu role="menu"
                            indigo-scroller="y"
                            indigo-scroller-theme="indigo-thick" class="show-hide-columns dropdown-menu-right">
                            <li role="menuitem"
                                ng-click="$event.stopPropagation();">
                                <button type="button" class="btn btn-default btn-small m-t5"
                                        ng-click="resetColumns()">Set default columns set
                                </button>
                            </li>
                            <li ng-repeat="column in myColumns | filter : {id:'!show-hide-columns'}"
                                role="menuitem"
                                ng-click="$event.stopPropagation();">
                                <indigo-checkbox indigo-label="{{column.name}}" indigo-model="column.isVisible"
                                                 indigo-change="saveInLocalStorage();"></indigo-checkbox>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row m-b20 ng-scope"  ng-if="!vm.showSummary">
                <div class="col-sm-7 m-bt-sm">
                    <div class="btn-toolbar">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-info btn-small" ng-disabled="true"
                                    ng-click="registerVC()">
                                <span class="fa fa-floppy-o"></span>
                                <span class="m-l5">Register VC</span>
                            </button>
                            <button type="button" class="btn btn-info btn-small"
                                    ng-disabled="true"
                                    ng-click="vnv()">VnV
                            </button>
                        </div>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-info btn-small"
                                    ng-disabled="vm.isReadonly"
                                    ng-click="vm.addNewBatch()">
                                <span class="fa fa-plus"></span>
                                <span class="m-l5">Add</span>
                            </button>
                            <button type="button" class="btn btn-info btn-small" ng-click="vm.deleteBatch()"
                                    ng-disabled="vm.isEditDisabled">
                                <span class="fa fa-trash"></span>
                                <span class="m-l5">Delete</span>
                            </button>
                            <button type="button" class="btn btn-info btn-small" ng-click="vm.duplicateBatch()"
                                    ng-disabled="vm.isEditDisabled">
                                <span class="fa fa-trash"></span>
                                <span class="m-l5">Duplicate</span>
                            </button>
                            <indigo-inline-loader promise="vm.batchOperation" on-status-changed="vm.onBatchOperationChanged(completed)"></indigo-inline-loader>
                        </div>
                    </div>
                </div>
                <!--TODO this functional doesn't work -->
                <div class="col-sm-5 text-align">
                    <span class="txt-small bold m-r5">SD File:</span>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-info btn-small" ng-click="vm.importSDFile()" ng-disabled="vm.isReadonly || vm.isBatchLoading">
                            <span class="fa fa-cloud-download"></span>
                            <span class="m-l5">Import</span>
                        </button>
                        <button type="button" class="btn btn-info btn-small" ng-click="vm.exportSDFile()"
                                ng-disabled="vm.isEditDisabled">
                            <span class="fa fa-cloud-upload"></span>
                            <span class="m-l5">Export</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="structure-preview-wrapper" ng-if="vm.showStructure">
                <img ng-src="data:image/svg+xml;base64,{{vm.selectedBatch.structure.image}}"
                     alt="Image is unavailable.">
            </div>
            <div class="row">
                <div class="col-xs-6">
                    <indigo-input indigo-label="Virtual Compound Id"
                                  indigo-model="vm.selectedBatch.virtualCompoundId"
                                  indigo-label-vertical="true"
                                  indigo-readonly="vm.isEditDisabled">
                    </indigo-input>
                    <indigo-select indigo-label="Sterioisomer Code"
                                   indigo-label-vertical="true"
                                   indigo-dictionary="Stereoisomer Code"
                                   indigo-item-prop="name,description"
                                   indigo-model="vm.selectedBatch.stereoisomer"
                                   indigo-readonly="vm.isEditDisabled">
                    </indigo-select>
                    <indigo-simple-text indigo-label="Calculated Compound MW"
                                        indigo-model="vm.selectedBatch.molWeight.value | round"
                                        indigo-empty-text="none">
                    </indigo-simple-text>
                    <indigo-simple-text indigo-label="Calculated Compound MF"
                                        indigo-model="vm.selectedBatch.formula"
                                        indigo-empty-text="none">
                    </indigo-simple-text>

                    <indigo-text-area indigo-label="Comments"
                                      indigo-model="vm.selectedBatch.comments"
                                      indigo-label-vertical="true"
                                      indigo-readonly="vm.isEditDisabled">
                    </indigo-text-area>

                </div>
                <div class="col-xs-6">
                    <indigo-text-area indigo-label="Structure comments"
                                      indigo-model="vm.selectedBatch.structureComments"
                                      indigo-label-vertical="true"
                                      indigo-readonly="vm.isEditDisabled">
                    </indigo-text-area>
                </div>
            </div>
        </div>
    </div>
</div>