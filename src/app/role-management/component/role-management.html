<div class="tab-content-pad role-management">
    <!-- fake fields are a workaround for chrome autofill getting the wrong fields -->
    <div class="row m-b20">
        <div class="col-sm-6">
            <button class="btn btn-primary" ng-click="vm.create()">
                <span class="fa fa-plus" aria-hidden="true"></span>
                <span class="m-l5" i-translate="CREATE_NEW_ROLE"></span>
            </button>
        </div>
        <div class="col-sm-6 text-right">
            <div class="search-field m-t5">
                <span class="fa fa-search"></span>
                <input type="search"
                       class="uui-search"
                       placeholder="Search"
                       ng-change="vm.search()"
                       id="searchRole"
                       ng-model="vm.searchText"
                       ng-model-options="{ debounce: 300 }">
            </div>
        </div>
    </div>
    <form ng-if="vm.role" class="panel panel-info edit-form animated" name="editForm" role="form" ng-submit="vm.save()"
          autocomplete="off">
        <div class="panel-heading" i-translate="CREATE_UPDATE_ROLE"></div>
        <div class="panel-body ">
            <div class="row">
                <!-- fake fields are a workaround for chrome autofill getting the wrong fields -->
                <input class="hidden" type="text" name="fakeusernameremembered"/>
                <input class="hidden" type="password" name="fakepasswordremembered"/>
                <div class="col-xs-6">
                    <simple-input>
                        <span i-translate="NAME"></span>
                        <input class="form-control"
                               name="name"
                               required
                               type="text"
                               maxlength="50"
                               ng-model="vm.role.name"
                               dynamic-validators="{roleExist: vm.roleExistValidation}">
                        <span ng-if="editForm.name.$error.roleExist" class="validate-error"
                              i-translate="NAME_ALREADY_EXIST"></span>
                    </simple-input>
                </div>
                <div class="col-xs-12 form-group">
                    <label i-translate="AUTHORITIES"></label>
                    <div class="row">
                        <div class="col-xs-3" ng-repeat="authority in vm.authorities track by $index">
                            <div>
                                <indigo-checkbox
                                    indigo-label="{{authority.description}}"
                                    indigo-disabled="authority.readonly"
                                    indigo-model="authority.checked"
                                    indigo-change="vm.updateAuthoritySelection(authority)"
                                    indigo-tooltip="{{authority.tooltip}}"
                                    indigo-tooltip-placement="right"
                                ></indigo-checkbox>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel-footer text-right">
            <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="vm.clear()">
                <span class="fa fa-ban"></span><span class="m-l5" i-translate="CANCEL"></span>
            </button>
            <button type="button" class="btn btn-default m-l5" data-dismiss="modal" ng-click="vm.resetAuthorities()">
                Reset
            </button>
            <button type="submit" ng-disabled="editForm.$invalid || vm.isSaving" class="btn btn-primary m-l5">
                <span class="fa fa-save"></span><span class="m-l5" i-translate="SAVE"></span>
            </button>
        </div>
    </form>
    <div class="table-responsive container-fluid">
        <div class="row">
            <div class="wrapper-authorities-col">
                <table class="table table-striped authorities-table authorities-column">
                    <thead>
                    <tr>
                        <th i-translate="ROLE_NAME"></th>
                    </tr>
                    <tbody>
                    <tr ng-repeat="role in vm.roles track by role.id">
                        <td>
                            <div class="role-name" uib-tooltip="{{role.name}}" ng-bind="role.name"></div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div indigo-scroller="x">
                <table class="table table-striped authorities-table">
                    <thead>
                    <tr>
                        <th ng-repeat="authority in vm.authorities track by $index"
                            uib-tooltip="{{authority.tooltip}}" tooltip-placement="top"
                            tooltip-append-to-body="true">
                            <p ng-bind="authority.description"></p>
                        </th>
                        <th i-translate="ACTION"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="role in vm.roles track by role.id">
                        <td ng-repeat="authority in vm.authorities track by $index">
                                <span ng-class="{'glyphicon glyphicon-ok-sign': vm.hasAuthority(role, authority)}"
                                      class="role-check-icon"></span>
                        </td>
                        <td>
                            <button type="submit"
                                    ng-click="vm.edit(role)"
                                    ng-if="!role.system"
                                    class="btn btn-info btn-small">
                                <span class="fa fa-pencil"></span>
                                <span class="m-l5" i-translate="EDIT"></span>
                            </button>
                            <button type="submit"
                                    ui-sref="entities.role-management.delete({id:role.id})"
                                    ng-if="!role.system"
                                    class="btn btn-info btn-small">
                                <span class="fa fa-trash"></span>
                                <span class="m-l5" i-translate="DELETE"></span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
